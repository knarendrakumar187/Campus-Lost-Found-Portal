{% extends 'lostfound/base.html' %}

{% block title %}{{ item.title }}{% endblock %}

{% block content %}
<div class="item-detail">
    <a href="{% url 'found_items_list' %}" class="back-link">‚Üê Back to Found Items</a>
    
    <div class="detail-container">
        <div class="detail-image">
            {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.title }}">
            {% else %}
                <div class="no-image-large">No Image Available</div>
            {% endif %}
        </div>
        
        <div class="detail-info">
            <h1>{{ item.title }}</h1>
            
            <div class="detail-meta">
                <p><strong>Category:</strong> {{ item.get_category_display }}</p>
                <p><strong>Status:</strong> <span class="status-{{ item.status }}">{{ item.get_status_display }}</span></p>
                <p><strong>Location Found:</strong> üìç {{ item.location_found }}</p>
                <p><strong>Date Found:</strong> {{ item.date_found }}</p>
                <p><strong>Posted by:</strong> {{ item.posted_by.username }}</p>
                <p><strong>Posted on:</strong> {{ item.created_at|date:"F d, Y" }}</p>
            </div>
            
            <div class="detail-description">
                <h3>Description</h3>
                <p>{{ item.description|linebreaks }}</p>
            </div>
            
            <div class="contact-section">
                <h3>Contact Information</h3>
                <div class="contact-info" id="contact-info-{{ item.pk }}">
                    {{ item.contact_info }}
                </div>
                <p><small>Click on the email or phone number above to contact them directly!</small></p>
                <div class="contact-buttons">
                    {% if item.posted_by.email %}
                        <a href="mailto:{{ item.posted_by.email }}" class="btn btn-primary contact-btn">
                            üìß Send Email
                        </a>
                    {% endif %}
                    <button onclick="copyContactInfo('{{ item.contact_info|escapejs }}', this)" class="btn btn-secondary contact-btn">
                        üìã Copy Contact Info
                    </button>
                </div>
            </div>
            
            <script>
                // Make contact info clickable
                (function() {
                    const contactDiv = document.getElementById('contact-info-{{ item.pk }}');
                    if (contactDiv) {
                        let text = contactDiv.innerHTML;
                        
                        // Email pattern
                        const emailPattern = /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g;
                        text = text.replace(emailPattern, function(email) {
                            return '<a href="mailto:' + email + '" class="contact-link email-link">üìß ' + email + '</a>';
                        });
                        
                        // Phone pattern
                        const phonePattern = /(\+?\d{1,3}[-.\s]?)?\(?\d{1,4}\)?[-.\s]?\d{1,4}[-.\s]?\d{1,9}/g;
                        text = text.replace(phonePattern, function(phone) {
                            const cleanPhone = phone.replace(/[^\d+]/g, '');
                            return '<a href="tel:' + cleanPhone + '" class="contact-link phone-link">üìû ' + phone.trim() + '</a>';
                        });
                        
                        contactDiv.innerHTML = text;
                    }
                })();
            </script>
        </div>
    </div>
</div>
{% endblock %}

